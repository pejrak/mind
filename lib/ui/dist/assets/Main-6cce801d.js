import{m as r,a as s,n as o,s as p,b as i,p as d,c as u,d as c,_ as l,T as h,V as g,l as f}from"./index-de8b3282.js";const _=n=>n.toISOString().slice(0,19).replace("T"," ");var v=function(){var t=this,e=t._self._c;return e("b-button-group",[e("a",{ref:t.exportLinkRef,attrs:{hidden:"",href:t.exportContent,download:t.exportFileName}},[t._v("Downloader")]),e("b-dropdown",{attrs:{variant:"primary",split:""},on:{click:t.triggerMemoryLoad},scopedSlots:t._u([{key:"button-content",fn:function(){return[e("b-icon-cloud-download"),t._v("Load")]},proxy:!0}])},[e("b-dropdown-item-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"fragmentLoadModal",expression:"`fragmentLoadModal`"}],attrs:{variant:"primary"}},[e("b-icon-cloud-arrow-down"),t._v("Load options")],1),e("b-dropdown-item-button",{attrs:{variant:"primary"},on:{click:t.triggerMemoryExport}},[e("b-icon-cloud-download-fill"),t._v("Export")],1)],1),e("b-button",{attrs:{disabled:!t.canSave,variant:"success",title:""},on:{click:t.triggerMemorySave}},[e("b-icon-cloud-upload"),t._v("Save")],1),e("b-button",{attrs:{disabled:t.memoryIsEmpty,variant:"danger"},on:{click:t.triggerMemoryPurge}},[e("b-icon-cloud-slash"),t._v("Clear")],1)],1)},b=[];const y={computed:{...r("authentication",["isAuthenticated","userEmailSnake"]),...r("fragments",["canSave","encodedRecall","memoryIsEmpty"]),exportLink(){return this.$refs[this.exportLinkRef]}},data(){return{exportContent:"#",exportFileName:"",exportLinkRef:"exportLinkRef"}},methods:{...s("fragments",["load","save","purge"]),formatTime:_,async triggerMemoryExport(){this.exportContent=`data:text/plain;charset=UTF-8,${this.encodedRecall}`,this.exportFileName=`recall_${Date.now()}_${this.userEmailSnake}.txt`,this.$nextTick(()=>{console.info("export",this.exportLink,this.userEmailSnake),this.exportLink.click()})},async triggerMemoryLoad(){this.isAuthenticated&&await this.load()},async triggerMemoryPurge(){await this.purge()},async triggerMemorySave(){await this.save()}}};var P=o(y,v,b,!1,null,null,null,null);const C=P.exports,$=n=>p.get("/component",{params:{name:n}});var x=function(){var t=this,e=t._self._c;return e("div",[e("b-input-group",[e("b-input-group-prepend",[e("b-input-group-text",[e("b-icon-search"),e("span",[t._v("Component")])],1)],1),e("b-input",{attrs:{type:"text"},model:{value:t.componentSearchInput,callback:function(a){t.componentSearchInput=a},expression:"componentSearchInput"}}),e("b-input-group-append",[e("b-button",{attrs:{variant:"primary",disabled:t.checking||!t.componentValid},on:{click:t.triggerComponentAddition}},[t._v("Add")])],1)],1),e("div",{staticClass:"spacer"}),t.pathComponents.length>0?e("div",[t._l(t.pathComponents,function(a){return e("b-button",{key:`path-component-${a}`,on:{click:function(m){return t.triggerComponentRemoval(a)}}},[t._v(t._s(a))])}),e("div",{staticClass:"spacer"}),e("b-button",{attrs:{variant:"success",disabled:!t.pathIsValid||t.pathAlreadyAdded},on:{click:t.submitNewPath}},[t._v("Save path: "),e("strong",[t._v(t._s(t.pathLabel))])])],2):e("b-alert",{attrs:{show:""}},[t._v("Add components to path.")])],1)},F=[];const k={computed:{...i("fragmentPaths",["available"]),pathAlreadyAdded(){return this.available.some(n=>d({parent:n,path:this.pathComponents}))},pathIsValid(){return this.pathComponents.length>1&&this.pathComponents.length<5},pathLabel(){return this.pathComponents.map(u).join(" - ")}},data(){return{checking:!1,componentSearchInput:"",componentSearchTimer:null,componentValid:!1,pathComponents:[]}},methods:{...c("fragmentPaths",["createFragmentPath"]),async checkComponentExistence(){if(this.componentSearchInput.length>1){this.checking=!0;const n=`${this.componentSearchInput}`,{data:{success:t}}=await $(n);t&&n===this.componentSearchInput&&(this.componentValid=!0),this.checking=!1}},submitNewPath(){this.createFragmentPath([...this.pathComponents]),this.pathComponents=[],this.$emit("submitted")},triggerComponentAddition(){this.pathComponents.push(this.componentSearchInput),this.componentSearchInput=""},triggerComponentCheck(){clearTimeout(this.componentSearchTimer),this.componentSearchTimer=setTimeout(()=>{this.checkComponentExistence()},400)},triggerComponentRemoval(n){const t=this.pathComponents.findIndex(e=>e===n);this.pathComponents.splice(t,1)}},watch:{componentSearchInput(n){this.componentValid=!1,this.triggerComponentCheck()}}};var S=o(k,x,F,!1,null,null,null,null);const M=S.exports;var R=function(){var t=this,e=t._self._c;return e("b-modal",{ref:t.dialogReference,attrs:{"ok-title":t.confirmTitle||"Yes","ok-only":t.confirmOnly,title:t.dialogTitle||"Confirmation required"},on:{ok:t.triggerConfirmation,cancel:t.triggerCancelation,close:t.triggerCancelation}},[t.confirmationMessage!==!1?e("div",{staticClass:"text-alert"},[t._v(t._s(t.confirmationMessage||t.defaultConfirmationMessage))]):t._e(),e("div",{staticClass:"spacer"}),t._t("default")],2)},w=[];const I="confirmationDialogModal",T={computed:{dialogReference(){return this.dialogRef||I}},data(){return{confirmFn:null,cancelFn:null,defaultConfirmationMessage:"OK to proceed?"}},methods:{show(){return this.$refs[this.dialogReference].show(),this},hide(){return this.$refs[this.dialogReference].hide(),this},onConfirm(n){this.confirmFn=n},onCancel(n){this.cancelFn=n},triggerConfirmation(){this.$emit("confirm"),typeof this.confirmFn=="function"&&this.confirmFn()},triggerCancelation(){this.$emit("cancel"),typeof this.cancelFn=="function"&&this.cancelFn()}},props:["confirmationMessage","confirmOnly","confirmTitle","dialogTitle","dialogRef"]};var A=o(T,R,w,!1,null,null,null,null);const E=A.exports;var L=function(){var t=this,e=t._self._c;return e("div",[e("ConfirmationDialog",{ref:"fragment-path-setup",attrs:{title:"Fragment path setup",confirmationMessage:!1,dialogTitle:"New path",confirmTitle:"Close",confirmOnly:!0}},[e("FragmentPathSetup",{on:{submitted:t.triggerSetupDialogExit}})],1),e("b-input-group",{staticClass:"offset-left"},[e("b-input-group-prepend",[e("b-input-group-text",[e("b-icon-diagram2"),e("span",[t._v("Path ("+t._s(t.availablePathOptions.length)+")")])],1)],1),e("b-dropdown",{attrs:{text:t.selectedFragmentPathName}},[t._l(t.availablePathOptions,function(a){return e("b-dropdown-item-button",{key:`fragment-path-option-${a.value}`,on:{click:function(m){return t.selectFragmentPath(a.value)}}},[e("b-icon-diagram2"),t._v(t._s(a.text))],1)}),e("b-dropdown-item-button",{staticClass:"add-path-button",on:{click:t.toggleFragmentPathSetup}},[e("b-icon-record"),e("b",[t._v("Add a path")])],1)],2)],1)],1)},N=[];const O={components:{ConfirmationDialog:E,FragmentPathSetup:M},computed:{...i("fragmentPaths",["selectedFragmentPath"]),...r("fragmentPaths",["availablePathOptions","selectedFragmentPathName"]),dialog(){return this.$refs["fragment-path-setup"]},selected:{get(){return this.selectedFragmentPathName},set(n){this.selectFragmentPath(n)}}},methods:{...s("fragmentPaths",["selectFragmentPath"]),toggleFragmentPathSetup(){this.dialog.show().onConfirm(()=>{})},triggerSetupDialogExit(){this.dialog.hide()}},mounted(){this.selectFragmentPath(this.selected)}};var D=o(O,L,N,!1,null,null,null,null);const V=D.exports;var B=function(){var t=this,e=t._self._c;return e("div",[e("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),e("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[e("b-navbar-nav",[e("MainMemoryControls")],1),e("b-navbar-nav",[e("FragmentPathSelection")],1)],1)],1)},z=[];const j={components:{MainMemoryControls:C,FragmentPathSelection:V}};var U=o(j,B,z,!1,null,null,null,null);const H=U.exports;var Y=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("b-button",{attrs:{block:t.block,disabled:t.busy||t.disabled,href:t.href,variant:t.variant,size:t.size,target:t.target,title:t.title},on:{click:t.onClick}},[t.busy?e("span",[e("b-spinner",{staticClass:"mr-1",attrs:{small:""}}),t._v(" "+t._s(t.busyLabel))],1):t._t("default")],2)},q=[];const G={methods:{onClick(){this.confirm&&!confirm(typeof this.confirm=="string"?this.confirm:"Are you sure?")||this.$emit("click")}},props:{block:{type:Boolean,default:!1},busy:{type:Boolean,default:!1},busyLabel:{type:String,default:"..."},confirm:{type:String|Boolean,default:null},disabled:{type:Boolean,default:!1},href:{type:String,default:null},size:{type:String,default:"md"},target:{type:String,default:null},title:{type:String,default:"Button"},variant:{type:String,default:"secondary"}}},K=G;var J=o(K,Y,q,!1,null,null,null,null);const Q=J.exports,W={components:{Button:Q},computed:{...r("authentication",["userEmailSnake","isAuthenticated"]),...r("peers",["isConnected"]),...i("authentication",["userEmail"]),...i("peers",{myConnectionId:"id"})},data(){return{peer:null,recipientId:null}},methods:{...s("peers",["connectMe","sendTo"]),onMessageRecipient(){this.sendTo({recipientId:this.recipientId,message:`Hello from ${this.myConnectionId}!`})}},watch:{isAuthenticated(n){n&&this.connectMe()}}};var X=function(){var t=this,e=t._self._c;return e("div",[e("b-navbar",{attrs:{href:"#",variant:"primary",type:"dark",fixed:"top",toggleable:"md"}},[e("b-navbar-brand",{attrs:{to:"/"}},[t._v("Mind")]),e("MainNavigation"),e("AuthenticationNavigation")],1),e("b-navbar",{attrs:{href:"#",variant:"primary",type:"dark",fixed:"bottom",toggleable:"md"}},[e("PeerControls")],1),e("router-view")],1)},Z=[];const tt=f(),et={components:{AuthenticationNavigation:()=>l(()=>import("./AuthenticationNavigation-23c55cc2.js"),["assets/AuthenticationNavigation-23c55cc2.js","assets/index-de8b3282.js","assets/index-3b62ff73.css"]),MainNavigation:H,PeerControls:W},computed:{...r("fragmentPaths",["selectedFragmentPathName"]),routedFragmentPath(){var n;return((n=this.$route.params)==null?void 0:n.fragmentPath)??""}},async mounted(){await this.getUser(),this.selectRoutedPath()},methods:{...s("authentication",["getUser"]),...c("fragmentPaths",["select"]),selectRoutedPath(){if(tt.info("selectRoutedPath",this.routedFragmentPath),!this.routedFragmentPath){this.$router.push({path:`/on/${h}`});return}if(this.routedFragmentPath!==this.selectedFragmentPathName){this.select(this.routedFragmentPath);return}}},router:new g({routes:[{path:"/",component:()=>l(()=>import("./MainContent-6b377448.js"),["assets/MainContent-6b377448.js","assets/index-de8b3282.js","assets/index-3b62ff73.css","assets/MainContent-8766c9b8.css"])},{path:"/on/:fragmentPath",component:()=>l(()=>import("./MainContent-6b377448.js"),["assets/MainContent-6b377448.js","assets/index-de8b3282.js","assets/index-3b62ff73.css","assets/MainContent-8766c9b8.css"])}]}),watch:{routedFragmentPath(n){this.$nextTick(()=>this.selectRoutedPath())},selectedFragmentPathName(){this.$nextTick(()=>{this.selectedFragmentPathName!==this.routedFragmentPath&&this.$router.push({path:`/on/${this.selectedFragmentPathName}`})})}}};var nt=o(et,X,Z,!1,null,null,null,null);const at=nt.exports,rt=Object.freeze(Object.defineProperty({__proto__:null,default:at},Symbol.toStringTag,{value:"Module"}));export{G as B,E as C,rt as M};
